!function(window,angular){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};angular.module("ui-leaflet").config(["$provide",function(e){return e.decorator("leafletHelpers",["$delegate","leafletLayersLogger",function(e,r){function a(e,r){if((void 0===e?"undefined":_typeof(e))+(void 0===r?"undefined":_typeof(r))!=="stringstring")return!1;for(var a=e.split("."),o=r.split("."),t=0,n=Math.max(a.length,o.length);t<n;t++){if(a[t]&&!o[t]&&0<parseInt(a[t])||parseInt(a[t])>parseInt(o[t]))return 1;if(o[t]&&!a[t]&&0<parseInt(o[t])||parseInt(a[t])<parseInt(o[t]))return-1}return 0}function o(r){return{isLoaded:function(){return angular.isDefined(r)},is:function(e){return!!this.isLoaded()&&e instanceof r}}}var t=r,n={BingLayerPlugin:o(L.BingLayer),ChinaLayerPlugin:o(L.tileLayer.chinaProvider),HeatLayerPlugin:o(L.heatLayer),LeafletProviderPlugin:o(L.TileLayer.Provider),MapboxGL:o(L.mapboxGL),UTFGridPlugin:o(L.UtfGrid),WebGLHeatMapLayerPlugin:o(L.TileLayer.WebGLHeatMap),WFSLayerPlugin:o(L.GeoJSON.WFS),YandexLayerPlugin:o(L.Yandex)};return-1===a(L.version,"1.0.0")?n.GoogleLayerPlugin=o(L.Google):n.GoogleLayerPlugin=o(L.GridLayer.GoogleMutant),n.versionCompare=a,angular.isDefined(L.esri)?angular.extend(n,{AGSBaseLayerPlugin:o(L.esri.basemapLayer),AGSClusteredLayerPlugin:o(L.esri.clusteredFeatureLayer),AGSDynamicMapLayerPlugin:o(L.esri.dynamicMapLayer),AGSFeatureLayerPlugin:o(L.esri.featureLayer),AGSImageMapLayerPlugin:o(L.esri.imageMapLayer),AGSHeatmapLayerPlugin:o(L.esri.heatmapFeatureLayer),AGSTiledMapLayerPlugin:o(L.esri.tiledMapLayer)}):angular.extend(n,{AGSBaseLayerPlugin:o(),AGSClusteredLayerPlugin:o(),AGSDynamicMapLayerPlugin:o(),AGSFeatureLayerPlugin:o(),AGSImageMapLayerPlugin:o(),AGSHeatmapLayerPlugin:o(),AGSTiledMapLayerPlugin:o()}),angular.isDefined(window.lvector)?angular.extend(n,{AGSLayerPlugin:o(window.lvector.AGS)}):angular.extend(n,{AGSLayerPlugin:o()}),angular.extend(e,n),t.info("[ui-leaflet-layers] - Layers plugin is loaded"),e}])}]),angular.module("ui-leaflet").config(["$provide",function($provide){return $provide.decorator("leafletLayerHelpers",["$delegate","$rootScope","$q","leafletHelpers","leafletLayersLogger",function($delegate,$rootScope,$q,leafletHelpers,leafletLayersLogger){var $log=leafletLayersLogger,isArray=leafletHelpers.isArray,isObject=leafletHelpers.isObject,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,utfGridCreateLayer=function(e){if(leafletHelpers.UTFGridPlugin.isLoaded()){var r=new L.UtfGrid(e.url,e.pluginOptions);return r.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),r.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),r.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),r.on("mousemove",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)}),r}$log.error(errorHeader+" The UTFGrid plugin is not loaded.")};return angular.extend($delegate.layerTypes,{ags:{mustHaveUrl:!0,createLayer:function(e){if(leafletHelpers.AGSLayerPlugin.isLoaded()){var r=angular.copy(e.options);angular.extend(r,{url:e.url});var a=new lvector.AGS(r);return a.onAdd=function(e){this.setMap(e)},a.onRemove=function(){this.setMap(null)},a}}},agsBase:{mustHaveLayer:!0,createLayer:function(e){if(leafletHelpers.AGSBaseLayerPlugin.isLoaded())return L.esri.basemapLayer(e.layer,e.options)}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){return leafletHelpers.AGSClusteredLayerPlugin.isLoaded()?leafletHelpers.MarkerClusterPlugin.isLoaded()?L.esri.clusteredFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded."):void $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){return leafletHelpers.AGSDynamicMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.dynamicMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(leafletHelpers.AGSFeatureLayerPlugin.isLoaded()){e.options.url=e.url;var r=L.esri.featureLayer(e.options),a=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return r.on("loading",function(){e.options.loadedDefer=$q.defer(),r.off("load",a),r.on("load",a)}),r}$log.warn(errorHeader+" The esri plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){return leafletHelpers.AGSHeatmapLayerPlugin.isLoaded()?leafletHelpers.HeatLayerPlugin.isLoaded()?L.esri.heatmapFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The heatlayer plugin is not loaded."):void $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){return leafletHelpers.AGSImageMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.imageMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){return leafletHelpers.AGSTiledMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.tiledMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){return leafletHelpers.BingLayerPlugin.isLoaded()?new L.BingLayer(e.key,e.options):void $log.error(errorHeader+" The Bing plugin is not loaded.")}},china:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"";return leafletHelpers.ChinaLayerPlugin.isLoaded()?L.tileLayer.chinaProvider(r,e.options):void $log.error(errorHeader+" The ChinaLayer plugin is not loaded.")}},google:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"SATELLITE";if(leafletHelpers.GoogleLayerPlugin.isLoaded()){return-1===leafletHelpers.versionCompare(L.version,"1.0.0")?new L.Google(r.toUpperCase(),e.options):new L.GridLayer.GoogleMutant({type:r.toLowerCase()})}$log.error(errorHeader+" The GoogleLayer plugin is not loaded.")}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(leafletHelpers.HeatLayerPlugin.isLoaded()){var r=new L.heatLayer;return isArray(e.data)&&r.setLatLngs(e.data),isObject(e.options)&&r.setOptions(e.options),r}$log.error(errorHeader+" The HeatMapLayer plugin is not loaded.")}},here:{mustHaveUrl:!1,createLayer:function(e){var r=e.provider||"HERE.terrainDay";if(leafletHelpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(r,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){return L.tileLayer("//api.mapbox.com/styles/v1/{user}/{mapId}/tiles/256/{z}/{x}/{y}?access_token={apiKey}",angular.extend(e.options,{mapId:e.key,user:e.user,apiKey:e.apiKey}))}},mapboxGL:{createLayer:function(e){return leafletHelpers.MapboxGL.isLoaded()?new L.mapboxGL(e.options):void $log.error(errorHeader+" The MapboxGL plugin is not loaded.")}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(leafletHelpers.WebGLHeatMapLayerPlugin.isLoaded()){var r=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&r.setData(e.data),r}$log.error(errorHeader+" The WebGLHeatMapLayer plugin is not loaded.")}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function createLayer(params){if(leafletHelpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}$log.error(errorHeader+" The WFSLayer plugin is not loaded.")}},yandex:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"map";return leafletHelpers.YandexLayerPlugin.isLoaded()?new L.Yandex(r,e.options):void $log.error(errorHeader+" The YandexLayer plugin is not loaded.")}}}),$delegate}])}]),angular.module("ui-leaflet").service("leafletLayersLogger",["nemSimpleLogger",function(e){return e.spawn()}])}(window,angular);